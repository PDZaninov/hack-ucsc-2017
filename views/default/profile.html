{{extend 'layout.html'}}
<script src="{{=URL('static', 'js/vue.js')}}"></script>
{{logged_in = auth.user_id is not None}}
<style>
    hr{
        border: 0;
        height: 5px;
        background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
    }
    #title{
        font-size: 250%;
    }
    body {
      background-image: url("../static/images/background.jpg");
      background-color: rgba(255,255,255,0.7);
      background-blend-mode:lighten;
      color:black;
    }
    #banner{
        text-align: center;
        background-color:grey;
        border-radius: 25px 124px 64px;
        font-size: 150%;
        width:45%;
        color: white;
        text-shadow: 2px 2px 10px Black;
    }
    #bannerl{
        text-align: center;
        background-color:royalblue;
        margin-top: 1%;
        font-size: 150%;
        width:45%;
        color: white;
        text-shadow: 2px 2px 10px Black;
    }
    #bannerD{
        text-align: center;
        background-color:black;
        margin-top: -12%;
        margin-left:60%;
        border-radius: 64px 124px 25px;
        font-size: 100%;
        width:25%;
        color: white;
        text-shadow: 2px 2px 10px Black;
    }

    #inner{
        text-align: center;
        background-color:white;
        margin-top: 0%;
        margin-left:0%;
        border-radius: 25px 49px 25px;
        font-size: 100%;
        width:50%;
        color: white;
        text-shadow: 2px 2px 10px Black;
    }






</style>


<div id="body">
    <br>
</div>

{{if logged_in:}}


<div id="banner">
    <div id="title">Hello {{=T(auth.user.first_name if auth.user.first_name else '')}}</div>
    <p>
        <strong>
            Here you can see your accumulated points and latest post.
        </strong>
    </p>
</div>

<div id="bannerl">
    <div id="title">Points: 50</div>
</div>

<div id="bannerD">
    <center>
        <div id="title">Photo Reel</div>
        <div id="picturelist">
            <div v-for="post in posts">
                <div id="inner">
                <img v-bind:src="post.img" alt="" height="127" width="127"/>
                <br>
                </div>
                <br>
            </div>
        </div>
        <script>
                var get_posts_user_url = "{{=URL('api', 'get_posts_user')}}";

                function extend(a, b) {
                    for (var i = 0; i < b.length; i++) {
                        a.push(b[i]);
                    }
                }
                var picturelist= new Vue({
                    el: "#picturelist",
                    delimiters: ['${', '}'],
                    unsafeDelimiters: ['!{', '}'],
                    data: {
                        posts:[],
                    },
                    methods: {
                        getPosts: function () {
                            $.post(get_posts_user_url, {
                                id: {{=auth.user_id}}
                            },
                                function(data) {
                                    picturelist.posts = [];
                                    extend(picturelist.posts, data.posts);
                                }
                            );
                        }
                    }
                });
                $(document).ready( function(){
                    picturelist.getPosts();
                });

        </script>
</div>

</center>
</div>
{{else:}}
<meta http-equiv="refresh" content="0; URL='http://127.0.0.1:8000/hack/default/index'"/>
{{pass}}


